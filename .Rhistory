arrange(desc(Aktivnost))
hdz %>%
group_by(type,source) %>%
summarise(Aktivnost = n()) %>%
arrange(desc(Aktivnost)) %>%
kable() %>% kable_styling()
hdz %>%
group_by(type,source) %>%
summarise(Broj = n()) %>%
arrange(desc(Aktivnost)) %>%
select(Izvor = source,Vrsta = type,Broj)
hdz %>%
group_by(type,source) %>%
summarise(Broj = n()) %>%
arrange(desc(Broj)) %>%
select(Izvor = source,Vrsta = type,Broj)
hdz %>%
group_by(author) %>%
summarise(Broj = n()) %>%
arrange(desc(Broj)) %>%
kable() %>% kable_styling()
unique(hdz$author)
## No GDPR
hdz %>%
group_by(author) %>%
summarise(Broj = n()) %>%
arrange(desc(Broj)) %>%
kable() %>% kable_styling() %>%
scroll_box(width = "500px", height = "400px")
hdz %>%
group_by(type,source) %>%
summarise(Broj = n()) %>%
arrange(desc(Broj)) %>%
ungroup() %>%
select(Izvor = source,Vrsta = type,Broj)
hdz %>%
group_by(type,source) %>%
summarise(Broj = n()) %>%
arrange(desc(Broj)) %>%
ungroup() %>%
select(Izvor = source,Vrsta = type,Broj) %>%
kable() %>%
kable_styling()
## No GDPR
hdz %>%
group_by(author) %>%
summarise(Broj = n()) %>%
arrange(desc(Broj)) %>%
ungroup() %>%
kable() %>%
scroll_box(width = "500px", height = "400px")
hdz %>%
group_by(type,source) %>%
summarise(Broj = n()) %>%
arrange(desc(Broj)) %>%
ungroup() %>%
select(Izvor = source,Vrsta = type,Broj) %>%
kable() %>%
kable_styling()
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
library(tidyverse)
library(janitor)
library(tidyverse)
library(httr)
library(jsonlite)
library(lubridate)
library(tidytext)
library(data.table)
library(wordcloud)
library(knitr)
library(gridExtra)
library(grid)
library(topicmodels)
library(rvest)
library(igraph)
library(ggraph)
library(scales)
library(widyr)
library(kableExtra)
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
hdz2 <- read.csv2("../Data/HDZscv.csv") %>%
select(X.3) %>%
row_to_names(.,1) %>%
mutate(Published = substr(Published,1,10)) #%>%
#mutate(Datum = as.Date(Published,"d%.m%.Y%"))
Datum  <- mutate(hdz2, b2= as.Date(Published, format= "%d.%m.%Y")) %>%
select(-Published) %>%
rename(Datum =b2)
hdz <- readxl::read_excel("../Data/HDZ.xlsx") %>%
row_to_names(.,1) %>%
clean_names() %>%
select(-c(1,17:25,28:33,37:41)) %>%
select(-published,-indexed,-category,-image,-languages) %>%
cbind.data.frame(Datum)
source("../Mfiles/mfiles.R")
CroSentilex_n <- read.delim(mfiles_downlaod_txt("0", 136679, 136711, ext = ".txt"),
header = FALSE,
sep = " ",
stringsAsFactors = FALSE) %>%
rename(word = "V1", sentiment = "V2" ) %>%
mutate(brija = "NEG")
CroSentilex_p <- read.delim(mfiles_downlaod_txt("0", 136681, 136713, ext = ".txt"),
header = FALSE,
sep = " ",
stringsAsFactors = FALSE) %>%
rename(word = "V1", sentiment = "V2" ) %>%
mutate(brija = "POZ")
Crosentilex_sve <- rbind(setDT(CroSentilex_n), setDT(CroSentilex_p))
#head(Crosentilex_sve)
CroSentilex_Gold  <- read.delim2(mfiles_downlaod_txt("0", 136680, 136712, ext = ".txt"),
header = FALSE,
sep = " ",
stringsAsFactors = FALSE) %>%
rename(word = "V1", sentiment = "V2" )
CroSentilex_Gold[1,1] <- "dati"
CroSentilex_Gold$sentiment <- str_replace(CroSentilex_Gold$sentiment , "-", "1")
CroSentilex_Gold$sentiment <- str_replace(CroSentilex_Gold$sentiment , "\\+", "2")
CroSentilex_Gold$sentiment <- as.numeric(unlist(CroSentilex_Gold$sentiment))
#head(CroSentilex_Gold)
# leksikoni
stopwords_cro <- get_stopwords(language = "hr", source = "stopwords-iso")
my_stop_words <- tibble(
word = c(
"jedan",
"e","prvi", "dva","dvije","drugi",
"tri","tre?i","pet","kod",
"ove","ova",  "ovo","bez",
"evo","oko",  "om", "ek",
"mil","tko","?est", "sedam",
"osam",   "?im", "zbog",
"prema", "dok","zato", "koji",
"im", "?ak","me?u", "tek",
"koliko", "tko","kod","poput",
"ba?", "dakle", "osim", "svih",
"svoju", "odnosno", "gdje",
"kojoj", "ovi", "toga","ima","treba","sad","to","kad", "?e","ovaj","?ta","onda","ce","ko"
),
lexicon = "lux"
)
stop_corpus <- my_stop_words %>%
bind_rows(stopwords_cro)
hdz %>%
group_by(author) %>%
mutate(total = count())
hdz %>%
group_by(author) %>%
count()
hdz %>%
mutate(ukupno = n())
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n())
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n())
unique(hdz$author)
hdz %>% group_by(author) %>% summarize(count=n())
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>% View()
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(author != NA) %>% View()
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(author == NA) %>% View()
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(author == "NA") %>% View()
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(!is.na(author)) %>% View()
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(!is.na(author)) %>%
arrange(desc(poAutoru)) %>% View()
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(!is.na(author)) %>%
arrange(desc(poAutoru)) %>%
summarise(Vaznost = (poAutoru / ukupno) *100)
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(!is.na(author)) %>%
summarise(Vaznost = (poAutoru / ukupno) *100) %>%
arrange(desc(poAutoru)) %>%
top_n(Vaznost, 15)
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(!is.na(author)) %>%
summarise(Vaznost = (poAutoru / ukupno) *100) %>%
arrange(desc(Vaznost)) %>%
top_n(Vaznost, 15)
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(!is.na(author)) %>%
summarise(Vaznost = (poAutoru / ukupno) *100) %>%
arrange(desc(Vaznost))
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(!is.na(author)) %>%
summarise(Vaznost = (poAutoru / ukupno) *100) %>%
arrange(desc(Vaznost)) %>%
top_n(15)
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(!is.na(author)) %>%
summarise(Vaznost = (poAutoru / ukupno) *100) %>%
arrange(desc(Vaznost)) %>%
ungroup()%>%
top_n(15) %>%
## No GDPR
hdz %>%
group_by(author) %>%
summarise(Broj = n()) %>%
arrange(desc(Broj)) %>%
ungroup() %>%
kable() %>%
scroll_box(width = "700px", height = "400px")
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(!is.na(author)) %>%
summarise(Vaznost = (poAutoru / ukupno) *100) %>%
arrange(desc(Vaznost)) %>%
ungroup()%>%
top_n(15)
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(!is.na(author)) %>%
summarise(Vaznost = (poAutoru / ukupno) *100) %>%
arrange(desc(Vaznost)) %>%
ungroup()%>%
distinct(author) %>%
top_n(15)
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(!is.na(author)) %>%
summarise(Vaznost = (poAutoru / ukupno) *100) %>%
arrange(desc(Vaznost)) %>%
ungroup()%>%
distinct(author, Vaznost) %>%
top_n(15)
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(!is.na(author)) %>%
summarise(Vaznost = (poAutoru / ukupno) *100)
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n())
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(!is.na(author))
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(!is.na(author)) %>%
summarise(Vaznost = (poAutoru / ukupno) *100) %>%
arrange(desc(Vaznost)) %>%
ungroup()%>%
distinct(author, Vaznost) %>%
top_n(15)
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(!is.na(author)) %>%
summarise(Vaznost = (poAutoru / ukupno) *100) %>%
arrange(desc(Vaznost)) %>%
ungroup()%>%
distinct(author, Vaznost) %>%
top_n(25)
hdz %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
filter(!is.na(author)) %>%
summarise(Vaznost = (poAutoru / ukupno) *100) %>%
arrange(desc(Vaznost)) %>%
ungroup()%>%
distinct(author, Vaznost) %>%
top_n(45) %>%
kable() %>%
scroll_box(width = "700px", height = "400px")
hdz %>%
group_by(author) %>%
filter(!is.na(author)) %>%
arrange(desc(audience))
hdz %>%
group_by(author) %>%
filter(!is.na(author)) %>%
top_n(audience)
hdz %>%
group_by(author) %>%
filter(!is.na(author)) %>%
arrange(desc(audience))
hdz %>%
group_by(author) %>%
filter(!is.na(author)) %>%
arrange(desc(audience)) %>%
View()
hdz %>%
group_by(author,source) %>%
filter(!is.na(author)) %>%
arrange(desc(audience)) %>%
View()
hdz %>%
group_by(author,source) %>%
filter(!is.na(author)) %>%
arrange(desc(audience)) %>%
summarise(PUblika = sum(audience)) %>%
View()
hdz %>%
group_by(author,source) %>%
filter(!is.na(author)) %>%
arrange(desc(audience)) %>%
summarise(PUblika = sum(audience)) %>%
View()
hdz %>%
group_by(source) %>%
summarise(audience)
hdz %>%
group_by(source) %>%
mutate(audience = is.numeric(audience)) %>%
summarise(publike = sum(audience))
hdz %>%
group_by(source) %>%
mutate(audience = is.numeric(audience)) %>%
summarise(publike = sum(audience, na.rm = TRUE))
hdz %>%
group_by(source) %>%
mutate(audience = is.numeric(audience))
hdz %>%
group_by(source) %>%
mutate(audience = as.numeric(audience)) %>%
summarise(publike = sum(audience, na.rm = TRUE))
hdz %>%
group_by(source) %>%
distinct(url) %>%
mutate(audience = as.numeric(audience)) %>%
summarise(publike = sum(audience, na.rm = TRUE))
hdz %>%
group_by(source) %>%
distinct(url)
hdz %>%
group_by(source) %>%
distinct(url) %>%
mutate(audience = as.numeric(audience))
hdz %>%
group_by(source) %>%
mutate(audience = as.numeric(audience)) %>%
hdz %>%
group_by(source) %>%
mutate(audience = as.numeric(audience))
hdz %>%
group_by(source) %>%
mutate(audience = as.numeric(audience))
hdz %>%
ungroup() %>%
group_by(source)
unique(hdz$source)
hdz %>%
group_by(source) %>%
count()
hdz %>%
mutate(publika = as.numeric(audience)) %>%
group_by(source) %>%
summarise(publika = sum(publika))
hdz %>%
mutate(publika = as.numeric(audience)) %>%
group_by(source) %>%
summarise(publika = sum(publika, na.rm = TRUE))
hdz %>%
filter(!is.na(author)) %>%
mutate(ukupno = n()) %>%
group_by(author) %>%
mutate(poAutoru = n()) %>%
summarise(Vaznost = (poAutoru / ukupno) *100) %>%
arrange(desc(Vaznost)) %>%
ungroup()%>%
distinct(author, Vaznost) %>%
top_n(45)
hdz %>%
mutate(publika = as.numeric(audience)) %>%
filter(!is.na(author)) %>%
group_by(source,author) %>%
summarise(Publika = sum(audience))
hdz %>%
mutate(publika = as.numeric(audience)) %>%
filter(!is.na(author)) %>%
group_by(author) %>%
summarise(Publika = sum(audience))
hdz %>%
mutate(publika = as.numeric(audience)) %>%
filter(!is.na(author))
hdz %>%
mutate(publika = as.numeric(audience)) %>%
filter(!is.na(author))
hdz %>%
mutate(publika = as.numeric(as.character(audience))) %>%
filter(!is.na(author)) %>%
group_by(author) %>%
summarise(Publika = sum(audience))
hdz %>%
mutate(publika = as.numeric(as.character(audience))) %>%
filter(!is.na(author))
str(hdz)
hdz <- hdz %>%
mutate(publika = as.numeric(as.character(audience)))
str(hdz)
hdz <- hdz %>%
filter(!is.na(c(author,publika)) %>%
mutate(publika = as.numeric(as.character(audience)))
)
hdz <- hdz %>%
filter(!is.na(author)) %>%
filter(!is.na(publika)) %>%
mutate(publika = as.numeric(as.character(audience)))
str(hdz)
hdz <- hdz %>%
filter(!is.na(author)) %>%
filter(!is.na(publika)) %>%
mutate(publika = as.numeric(as.character(audience))) %>%
group_by(author) %>%
summarise(Publika = sum(publika))
hdz <- hdz %>%
filter(!is.na(author)) %>%
filter(!is.na(publika)) %>%
mutate(publika = as.numeric(as.character(audience))) %>%
group_by(author) %>%
summarise(Publika = sum(publika))
hdz
hdz <- hdz %>%
filter(!is.na(author)) %>%
filter(!is.na(publika)) %>%
mutate(publika = as.numeric(as.character(audience))) %>%
group_by(author) %>%
summarise(Publika = sum(publika)) %>%
top_n(publika,15)
hdz <- hdz %>%
filter(!is.na(author)) %>%
filter(!is.na(publika)) %>%
mutate(publika = as.numeric(as.character(audience))) %>%
group_by(author) %>%
summarise(Publika = sum(publika)) %>%
arrange(desc(publika))
hdz %>%
filter(!is.na(author)) %>%
filter(!is.na(publika)) %>%
mutate(publika = as.numeric(as.character(audience))) %>%
group_by(author) %>%
summarise(Publika = sum(publika))
hdz <- hdz %>%
filter(!is.na(author)) %>%
filter(!is.na(publika)) %>%
mutate(publika = as.numeric(as.character(audience))) %>%
group_by(author) %>%
summarise(Publika = sum(publika)) %>%
arrange(desc(Publika))
hdz <- hdz %>%
filter(!is.na(author)) %>%
filter(!is.na(publika)) %>%
mutate(publika = as.numeric(as.character(audience))) %>%
group_by(author) %>%
summarise(Publika = sum(publika)
hdz
hdz
hdz %>%
filter(!is.na(author)) %>%
filter(!is.na(publika)) %>%
mutate(publika = as.numeric(as.character(audience))) %>%
group_by(author) %>%
summarise(Publika = sum(publika)) %>%
arrange(desc(Publika))
hdz%>%
arrange(desc(Publika))
